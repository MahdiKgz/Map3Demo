import { createSlice } from "@reduxjs/toolkit";

const initialState = {
  models: [
    {
      id: "car-1",
      url: "/models/car.glb",
      color: "#ff0000",
      speed: 0.0002,
      type: "vehicle",
      route: [
        [51.398022850690126, 35.733205165683046],
        [51.39934016280381, 35.73317578870555],
        [51.4002738620502, 35.73315816251335],
        [51.40113518150946, 35.733164037910996],
        [51.40178659958772, 35.733152287115246],
        [51.40306048382982, 35.732694004724195],
        [51.403943695308044, 35.732396137530415],
        [51.40475314112226, 35.73211493316144],
        [51.40481498533569, 35.731374181669906],
        [51.404834915300256, 35.73077557768636],
        [51.404834915300256, 35.730698729551406],
        [51.405612183924376, 35.73083220257975],
        [51.4066172833011, 35.730958366468414],
        [51.40759385157244, 35.731108017542454],
        [51.40828037764771, 35.73119457019273],
        [51.40909750620102, 35.73111772246203],
        [51.409145735798575, 35.73071155263108],
        [51.40933008797191, 35.73055785616408],
        [51.409325105481145, 35.7302140603623],
        [51.40933039674803, 35.729764215892104],
      ],
    },
    {
      id: "air-1",
      url: "/models/airplane_model.glb",
      color: "#ffaa00",
      speed: 0.00025,
      type: "airplane",
      altitude: 100, // meters above ground
      scale: 0.5, // airplane model scale
      route: [
        [51.4107518760224, 35.73372640732208],
        [51.41335145226475, 35.73440710755406],
        [51.41578331391091, 35.72762253525313],
        [51.41357507172708, 35.72723677297601],
        [51.4107518760224, 35.73372640732208],
      ],
    },
    {
      id: "sat-1",
      url: "/models/satellite.glb",
      color: "#00ffaa",
      type: "satellite",
      tle: {
        line1:
          "1 25544U 98067A   24257.12345678  .00001264  00000-0  29621-4 0  9991",
        line2:
          "2 25544  51.6442  21.8765 0007291  32.5541  84.1247 15.48987654321689",
      },
      altitudeOffset: 0, // meters to offset altitude visualization if desired
      scale: 100000,
    },
    {
      id: "car-2",
      url: "/models/car.glb",
      color: "#0000ff",
      speed: 0.00015,
      type: "vehicle",
      route: [
        [51.42027056779517, 35.728983329007335],
        [51.41953612274739, 35.7287811344889],
        [51.41912738811217, 35.7286722603051],
        [51.41891344107589, 35.72865670683777],
        [51.41871226699783, 35.72869299825625],
        [51.418469580807965, 35.728778542248406],
        [51.41836420390982, 35.72891852312844],
        [51.41825244053359, 35.729167377418335],
        [51.41818218926818, 35.72934883318129],
        [51.417967776049494, 35.72987291719609],
        [51.41784962619403, 35.73012695289846],
        [51.41774105605688, 35.7303991331091],
        [51.417552657475625, 35.73084498963787],
        [51.417523918320995, 35.73092016263509],
        [51.41715350255862, 35.7308009226752],
        [51.416206702392, 35.7305356891639],
        [51.415471194757004, 35.73032671620719],
        [51.41497823315095, 35.730200312627375],
        [51.414794356241345, 35.7307845835077],
        [51.41472605910468, 35.731044731936336],
        [51.414351279931026, 35.73207948902058],
        [51.41404188056981, 35.73298268310447],
        [51.41378603109723, 35.73373131214848],
        [51.41369083129433, 35.734016272322194],
        [51.412821611992086, 35.733755405337504],
        [51.411941013808814, 35.73352357264895],
        [51.41098190511289, 35.733282357993716],
        [51.41081530545685, 35.73323888915782],
        [51.410577305947754, 35.733702555516004],
        [51.410375006364745, 35.734151729726605],
        [51.41033930643866, 35.734243496189634],
      ],
    },
    {
      id: "moto-1",
      url: "/models/motor.glb",
      color: "#00c1ff",
      speed: 0.0003,
      type: "vehicle",
      scale: 0.09,
      route: [
        [51.415117108854076, 35.7269586109375],
        [51.413838062458666, 35.72659948459575],
        [51.4136841922151, 35.72659167748344],
        [51.41353993886236, 35.72688054013143],
        [51.4136841922151, 35.727169401731274],
        [51.41346300373979, 35.72763001671075],
        [51.41328989971595, 35.72776273578636],
        [51.41308794502254, 35.728020366302516],
        [51.4127225031946, 35.72863711475959],
        [51.41247246404973, 35.72905088003495],
        [51.41227050935473, 35.729456836329476],
        [51.41182813240576, 35.730112607511316],
        [51.41161656082147, 35.730479524745164],
        [51.41111648253178, 35.73030777646308],
        [51.41091452783678, 35.73022190218313],
        [51.410385598875905, 35.7301204142785],
        [51.40944314363725, 35.7301204142785],
        [51.40931955023194, 35.73012052343098],
        [51.40931955023194, 35.73019686499137],
        [51.40931540132573, 35.73056173172553],
        [51.40927667789654, 35.73061561959537],
        [51.40915497569111, 35.73070094198056],
        [51.40912178418168, 35.730813208138215],
        [51.409118287708935, 35.73108717135756],
        [51.409107223871246, 35.73112197371471],
        [51.40882233007136, 35.73114330418396],
        [51.40832337375434, 35.73117906037315],
        [51.408229703072095, 35.7311966192066],
        [51.408352788256536, 35.731318988548594],
        [51.40842885213405, 35.731386347739175],
        [51.40879534173121, 35.73163445360058],
        [51.40937819534133, 35.732011874052006],
        [51.40979627736323, 35.73229494890167],
        [51.4101242112759, 35.732512877118666],
      ],
    },
  ],
  chasedModelId: null,
};

const modelsSlice = createSlice({
  name: "models",
  initialState,
  reducers: {
    updateModelSpeed: (state, action) => {
      const { id, speed } = action.payload;
      const model = state.models.find((m) => m.id === id);
      if (model) model.speed = speed;
    },
    setChasedModel: (state, action) => {
      state.chasedModelId = action.payload;
    },
  },
});

export const { updateModelSpeed, setChasedModel } = modelsSlice.actions;
export default modelsSlice.reducer;
